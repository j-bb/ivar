<?xml version="1.0" encoding="UTF-8"?>

<project name="intellij build - composer enhance" basedir="." default="enhance">
    <description>
        Specific for IntelliJ.
        Ant build file to enhance at build-time OpenJPa persistent entity classes.
    </description>

    <target name="enhance">
        <echo message="Enhancing common and composer ..."/>
        <java classname="org.apache.openjpa.enhance.PCEnhancer" failonerror="true" fork="true">
            <jvmarg value="-Dfile.encoding=UTF-8"/>
            <classpath>
                <fileset dir="../lib/commons">
                    <include name="*.jar"/>
                </fileset>
                <fileset dir="../lib/jpa">
                    <include name="*.jar"/>
                </fileset>
                <fileset dir="../lib/openjpa">
                    <include name="*.jar"/>
                </fileset>

                <pathelement location="/Users/jbb/Dev/Projects/orbiter-engine-root/out/production/jfwk"/>
                <pathelement location="/Users/jbb/Dev/Projects/orbiter-engine-root/out/production/common"/>
                <pathelement location="/Users/jbb/Dev/Projects/orbiter-engine-root/out/production/composer"/>
                <pathelement path="src"/>
            </classpath>
            <arg value="-properties"/>
            <arg value="META-INF/persistence.xml#openjpa"/>
        </java>
        <echo message="Enhancing common and composer. Done."/>
    </target>

    <target name="install-composer-database-schema" depends="enhance">
        <echo message="Installing composer database..."/>
        <java classname="org.apache.openjpa.jdbc.meta.MappingTool" failonerror="true" fork="true">
            <jvmarg value="-Dfile.encoding=UTF-8"/>
            <classpath>
                <fileset dir="../jfwk/lib/commons">
                    <include name="*.jar"/>
                </fileset>
                <fileset dir="../jfwk/lib/jpa">
                    <include name="*.jar"/>
                </fileset>
                <fileset dir="../jfwk/lib/jdbc/mysql">
                    <include name="*.jar"/>
                </fileset>
                <fileset dir="../jfwk/lib/connection-pool">
                    <include name="*.jar"/>
                </fileset>
                <fileset dir="../jfwk/lib/openjpa">
                    <include name="*.jar"/>
                </fileset>

                <pathelement location="/Users/jbb/Dev/Projects/orbiter-engine-root/out/production/jfwk"/>
                <pathelement location="/Users/jbb/Dev/Projects/orbiter-engine-root/out/production/common"/>
                <pathelement location="/Users/jbb/Dev/Projects/orbiter-engine-root/out/production/composer"/>
                <pathelement path="src"/>
            </classpath>
            <arg value="-properties"/>
            <arg value="META-INF/persistence.xml#openjpa"/>
            <arg value="-action"/>
            <arg value="buildSchema"/>
        </java>
        <echo message="Installing composer database. Done."/>

    </target>
</project>