##
##   Copyright (c) 2004-2020, Jean-Baptiste BRIAUD. All Rights Reserved.
##
##   Licensed under the Apache License, Version 2.0 (the "License");
##   you may not use this file except in compliance with the License.
##   You may obtain a copy of the License at
##
##       http://www.apache.org/licenses/LICENSE-2.0
##
##   Unless required by applicable law or agreed to in writing, software
##   distributed under the License is distributed on an "AS IS" BASIS,
##   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
##   See the License for the specific language governing permissions and
##   limitations under the License
##
#parse("common/common.vm")
<?xml version="1.0" encoding="UTF-8"?>
#parse( "common/xml_general_copyright.vm" )

<project name="${application.getKeyname()}-package">
    <description>
        Build file generated by Orbiter Engine for the packaging the application ${application.getKeyname()}
    </description>

    <target name="zip-for-delivery">
        <echo message="((( Creating ${dollar}{root-dir}/../${application.getKeyname()}-${compiler.getDbArchLowerCase()}-${dollar}{prodvalue}-${generator.getUniqueCompileDateString()}.zip ..."/>
        <zip destfile="${dollar}{root-dir}/../${application.getKeyname()}-${compiler.getDbArchLowerCase()}-${dollar}{prodvalue}-${generator.getUniqueCompileDateString()}.zip"
             compress="yes" level="9" update="no"
             comment="Copyright Orbiter Engine. http://www.digitalorbiter.com">
            <zipfileset dir="${dollar}{root-dir}"
                        prefix="${application.getKeyname()}-${compiler.getDbArchLowerCase()}-${dollar}{prodvalue}-${generator.getUniqueCompileDateString()}">
                <exclude name="**/.subversion"/>
                <exclude name="**/.svn"/>
                <exclude name="**/._*"/>
                <exclude name="**/._*"/>
                <exclude name="**/__MAC*"/>
                <exclude name="**/.DS_Store"/>
            </zipfileset>
        </zip>
        <echo message="))) Creating ${dollar}{root-dir}/../${application.getKeyname()}-${compiler.getDbArchLowerCase()}-${dollar}{prodvalue}-${generator.getUniqueCompileDateString()}.zip. Done."/>
    </target>

    <target name="zip-for-runtime" depends="zip-for-delivery">
        <move file="${dollar}{root-dir}/../${application.getKeyname()}-${compiler.getDbArchLowerCase()}-${dollar}{prodvalue}-${generator.getUniqueCompileDateString()}.zip"
              todir="${dollar}{root-dir}" overwrite="true">
        </move>
    </target>

    <target name="zip-for-cloud">
        <zip destfile="${dollar}{root-dir}/../${application.getKeyname()}-${compiler.getDbArchLowerCase()}-${dollar}{prodvalue}-${generator.getUniqueCompileDateString()}.zip"
             compress="yes" level="9" update="no"
             comment="Copyright Orbiter Engine. http://www.digitalorbiter.com">
            <zipfileset dir="${dollar}{root-dir}"
                        prefix="${application.getKeyname()}-${compiler.getDbArchLowerCase()}-${dollar}{prodvalue}-${generator.getUniqueCompileDateString()}">
                <exclude name="engine-power/**/*"/>
                <exclude name="**/*.war"/>
                <exclude name="**/*.zip"/>
                <exclude name="**/.subversion"/>
                <exclude name="**/.svn"/>
                <exclude name="**/.git"/>
                <exclude name="**/._*"/>
                <exclude name="**/._*"/>
                <exclude name="**/__MAC*"/>
                <exclude name="**/.DS_Store"/>
            </zipfileset>
        </zip>

        <move file="${dollar}{root-dir}/../${application.getKeyname()}-${compiler.getDbArchLowerCase()}-${dollar}{prodvalue}-${generator.getUniqueCompileDateString()}.zip"
              todir="${dollar}{root-dir}" overwrite="true">
        </move>
    </target>

    <target name="zip-for-archive">
        <echo message="((( Creating ${dollar}{root-dir}/../${application.getKeyname()}-${compiler.getDbArchLowerCase()}-${dollar}{prodvalue}-${generator.getUniqueCompileDateString()}-archive.zip ..."/>
        <zip destfile="${dollar}{root-dir}/../${application.getKeyname()}-${compiler.getDbArchLowerCase()}-${dollar}{prodvalue}-${generator.getUniqueCompileDateString()}-archive.zip"
             compress="yes" level="9" update="no"
             comment="Copyright Orbiter Engine. http://www.digitalorbiter.com">

            <zipfileset dir="${dollar}{root-dir}"
                        prefix="${application.getKeyname()}-${compiler.getDbArchLowerCase()}-${dollar}{prodvalue}-${generator.getUniqueCompileDateString()}-archive">
                <exclude name="icons/**/*"/>
                <exclude name="**/*.war"/>
                <exclude name="**/*.zip"/>
                <exclude name="**/.subversion"/>
                <exclude name="**/.svn"/>
                <exclude name="**/._*"/>
                <exclude name="**/._*"/>
                <exclude name="**/__MAC*"/>
                <exclude name="**/.DS_Store"/>
            </zipfileset>
        </zip>
        <echo message="))) Creating ${dollar}{root-dir}/../${application.getKeyname()}-${compiler.getDbArchLowerCase()}-${dollar}{prodvalue}-${generator.getUniqueCompileDateString()}-archive.zip. Done."/>
    </target>
</project>